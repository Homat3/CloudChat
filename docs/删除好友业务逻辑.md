# 删除好友业务逻辑
## 客户端
客户端点击删除好友按钮，向服务端发送一个 DELETE_CONTACT 消息，等待服务端回复。

若服务端回复 CONTACT_DELETED，则更新本地联系人列表和 UI；若服务端回复 CONTACT_DELETED_FAILED，则显示错误信息。

客户端在线时，若被某个联系人删除好友，将会收到服务端发来的 DELETED_BY_CONTACT 消息，根据 DELETED_BY_CONTACT 消息内容更新本地联系人列表和 UI。
## 服务端
服务端收到 DELETE_CONTACT 消息时，根据解析出的 userId 和 targetId 尝试更新 friends 数据表。

若更新失败，则回复 CONTACT_DELETED_FAILED 消息给发送请求的客户端；若更新成功，则回复 CONTACT_DELETED 消息给客户端，同时查看 id 为 targetId 的用户是否在线，若在线，则通过 Websocket 向其发送 DELETED_BY_CONTACT 消息。
## 消息结构
### DELETE_CONTACT
```
userId: int
targetId: int
```
### CONTACT_DELETED
```
targetId: int
```
### CONTACT_DELETED_FAILED
```
error: string
```
### DELETED_BY_CONTACT
```
contactId: int // contactId 取自用户 id
```