<!-- chat-area.component.html -->
<div class="chat-container">
  <!-- é¡¶éƒ¨ä¿¡æ¯æ  -->
  <div class="chat-header">
    <div class="contact-info">
      <div class="avatar">{{ selectedContact?.name?.charAt(0) || 'U' }}</div>
      <div class="contact-details">
        <div class="contact-name">{{ selectedContact?.name || 'è¯·é€‰æ‹©ä¸€ä¸ªè”ç³»äºº' }}</div>
        <div class="contact-status">{{ selectedContact?.status || '' }}</div>
      </div>
    </div>
    <div class="header-actions">
      <button class="icon-button" title="è¯­éŸ³é€šè¯"
              (click)="selectedContact && sendEmoji('ğŸ“')"
              [disabled]="!selectedContact">
        <i>ğŸ“</i>
      </button>
      <button class="icon-button" title="è§†é¢‘é€šè¯"
              (click)="selectedContact && sendEmoji('ğŸ“¹')"
              [disabled]="!selectedContact">
        <i>ğŸ“¹</i>
      </button>
      <button class="icon-button" title="æ›´å¤šé€‰é¡¹"
              (click)="selectedContact && sendEmoji('â‹¯')"
              [disabled]="!selectedContact">
        <i>â‹¯</i>
      </button>
    </div>
  </div>

  <!-- ä¸­é—´æ¶ˆæ¯åŒº -->
  <div class="chat-messages" #chatMessagesContainer *ngIf="selectedContact; else noContactSelected">
    <div class="date-divider">ä»Šå¤©</div>
    @for (message of messages; track message.id) {
      <div
        class="message-bubble"
        [class.own-message]="message.sender === 'me'"
        [class.other-message]="message.sender === 'other'"
        [class.new-message]="isNewMessage(message)"
        [class.new-received-message]="isNewReceivedMessage(message)">
        <div class="message-content">
          {{ message.content }}
        </div>
        <div class="message-time">{{ message.timestamp }}</div>
      </div>
    }
  </div>

  <ng-template #noContactSelected>
    <div class="no-contact-selected">
      <div class="welcome-message">
        <h2>æ¬¢è¿ä½¿ç”¨ CloudChat</h2>
        <p>è¯·é€‰æ‹©ä¸€ä¸ªè”ç³»äººå¼€å§‹èŠå¤©</p>
        <div class="welcome-icon">ğŸ’¬</div>
      </div>
    </div>
  </ng-template>

  <!-- åº•éƒ¨è¾“å…¥åŒº -->
  <div class="input-area">
    <div class="input-container">
      <div class="input-actions">
        <button class="icon-button"
                (click)="sendEmoji('ğŸ˜Š')"
                [disabled]="!selectedContact"
        >ğŸ˜Š</button>
        <button class="icon-button"
                (click)="sendEmoji('ğŸ“')"
                [disabled]="!selectedContact"
        >ğŸ“</button>
        <button class="icon-button"
                (click)="sendEmoji('ğŸ“')"
                [disabled]="!selectedContact"
        >ğŸ“</button>
        <button class="icon-button"
                (click)="sendEmoji('ğŸ¤')"
                [disabled]="!selectedContact"
        >ğŸ¤</button>
        <button class="icon-button"
                (click)="sendEmoji('ğŸ“')"
                [disabled]="!selectedContact"
        >ğŸ“</button>
        <!-- ä»…ç”¨äºæµ‹è¯•çš„æŒ‰é’® -->
        <button class="icon-button"
                (click)="simulateReceiveMessage()"
                [disabled]="!selectedContact"
                title="æ¨¡æ‹Ÿæ¥æ”¶æ¶ˆæ¯"
                style="font-size: 12px;"
        >ğŸ“¥</button>
      </div>
      <textarea
        class="message-input"
        placeholder="{{selectedContact ? 'è¾“å…¥æ¶ˆæ¯...' : 'è¯·å…ˆé€‰æ‹©ä¸€ä¸ªè”ç³»äºº'}}"
        [(ngModel)]="newMessage"
        (keydown.enter)="sendMessage($event)"
        [disabled]="!selectedContact"
      ></textarea>
    </div>
    <button class="send-button"
            (click)="sendMessage()"
            [disabled]="!selectedContact || !newMessage.trim()">å‘é€</button>
  </div>
</div>
